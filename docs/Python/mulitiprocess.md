### Python 多进程





















#### 踩坑

##### 坑一： 关于 `if name=='__main__'` 的应用

在我们目前看到的所有的代码中，我们发现，所有创建子进程的过程都会出现 `if name=='__main__'` 这句。

python中文件的使用有两种方法：

* 作为程序被执行
* 作为模块被其他程序所调用

而 `if name=='__main__'` 的作用就是控制着两种不同的方法执行代码的过程。 在 `if name=='__main__'` 下的代码只有在作为程序被执行的时候才会执行，而被其他程序 import 的时候是不执行的。 

**但是在多进程的时候这个就成了大坑了。**

因为python在创建子进程的时候， 进程会默认导入目前正在运行的文件（也就是将本文件从头到尾开始运行），但是如果我们不用 `if name=='__main__'`的话，子进程会运行到创建子进程这句代码（也是这个文件的一部分），这就陷入了一个无限的循环，而被python所制止，所以一定要加 `if name=='__main__'`. 

但是问题来了，那些成熟的module 如 sklearn, 他们是怎么实现在函数中进行多进程的呢？？？略微查了一下，sklearn 应用的主要是 joblib库，那 joblib库怎么实现的呢？？？暂时我也不知道....巨坑啊.....





